{% extends "layouts/base.html" %}

{% block title %} CADD | URA Research Group {% endblock %} 

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}
<!-- ChemDoodle -->
<link rel="stylesheet" href="static/assets/vendor/chemdoodle/ChemDoodleWeb.css" type="text/css">
<script type="text/javascript" src="static/assets/vendor/chemdoodle/ChemDoodleWeb.js"></script>
<link rel="stylesheet" href="static/assets/vendor/chemdoodle/uis/jquery-ui-1.11.4.css" type="text/css">
<script type="text/javascript" src="static/assets/vendor/chemdoodle/uis/ChemDoodleWeb-uis.js"></script>
<link rel="stylesheet" href="systemcss/style.css">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />
<!-- NGL Viewer -->
<script src="static/assets/vendor/ngl/dist/ngl.js" type="text/javascript"></script>
{% endblock stylesheets %}

{% block content %}

    <main>
        
        {% include 'includes/preloader.html' %}

        <!-- Hero -->
        <section class="section-header overflow-hidden pt-7 pt-lg-8 pb-9 pb-lg-12 bg-primary text-white">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-12 col-md-8 text-center">
                        <h1 class="display-2 mb-2">Computer-Aided Drug Design System</h1>
                        <p>From BK with Love 
                            <span class="fas fa-heart"></span>
                            <span class="fas fa-heart"></span>
                            <span class="fas fa-heart"></span>
                        </p>
                    </div>
                </div>
            </div>
            <figure class="position-absolute bottom-0 left-0 w-100 d-none d-md-block mb-n2"><svg class="fill-white"
                xmlns="http://www.w3.org/2000/svg" viewBox="0 0 3000 185.4">
                <path d="M3000,0v185.4H0V0c496.4,115.6,996.4,173.4,1500,173.4S2503.6,115.6,3000,0z"></path>
            </svg></figure>
        </section>

        <div class="section py-0">
            <div class="container mt-n8 mt-lg-n12 z-2">
                <div class="row justify-content-center">
                    <div class="col-12 col-md-12 pt-2 pt-md-1">
                        <!-- for best results, center the entire wrapper -->
                    <center>
                        <!-- the chemdoodle div wraps the entire sketcher and forms the application window, we set the font to be used in the window here as well as render a nice gradient -->
                        <div id="chemdoodle" style="font-family:Century Gothic, Tahoma, Geneva, sans-serif;font-size:12px;text-align:left;text-shadow:none;display:inline-block;padding:5px;border-radius:3px;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);background:linear-gradient(to bottom, rgba(246,248,249,1) 0%,rgba(229,235,238,1) 50%,rgba(215,222,227,1) 51%,rgba(245,247,249,1) 100%);">
                        <!-- the title bar contains the welcome message and the logo, we use a data URI to avoid an additional resource download -->
                        <div id="titlebar" style="font-size:16px;font-weight:bold;cursor:move;padding:5px;padding-left:40px;border-radius:3px;color:#004E19;background:url(data:image/png;base64,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) no-repeat left center;background-size:32px 32px;background-position: 3px 0px;">
                            Let's create candidate compounds for treating COVID-19
                            <button type="submit" class="btn btn-primary" onclick="submit_compound()" style="float:right;">Submit</button>
                        </div>
                        <div>
                            
                        </div>
                        <script>
                            ChemDoodle.ELEMENT['H'].jmolColor = 'black';
                            ChemDoodle.ELEMENT['S'].jmolColor = '#B9A130';

                            // the sketcher is initialized here, setting the resizable and floatDrawTools options to true
                            let sketcher = new ChemDoodle.SketcherCanvas('sketcher', screen.width*0.66, 400, {resizable:true, floatDrawTools:true, oneMolecule:true});
                            
                            // we don't load any content, so we have to manually call the repaint method to show the sketcher, alternatively, you can preload content into the sketcher
                            sketcher.styles.atoms_displayTerminalCarbonLabels_2D = true;
                            sketcher.styles.atoms_useJMOLColors = true;
                            sketcher.styles.bonds_clearOverlaps_2D = true;
                            sketcher.styles.bonds_overlapClearWidth_2D = 2;
                            sketcher.repaint();

                            function alertMolecule(mol){
                                let message = 'This molecule contains '+mol.atoms.length+' atoms and '+mol.bonds.length+' bonds.';
                                alert(message);
                            }
                        </script>
                        <!-- the footer bar contains two spans for the left and the right -->
                        <div id="footerbar" style="padding:5px;margin:-5px;border-radius:0 0 3px 3px;background:#004E19;color:white;"><span>Include some updating calculations here</span><span style="float:right;font-size:8px;">Copyright Â© 2000-<script>document.write(new Date().getFullYear())</script> MyCompany. All Rights Reserved.</span></div>
                        </div>
                    </center>

                    <script>
                        // to finish setting everything up
                        let cdwindow = ChemDoodle.lib.jQuery('#chemdoodle');
                        // we make the application window draggable to it can be moved
                        cdwindow.draggable({ handle:'#titlebar', stop:function(){ cdwindow.css({width:'auto', height:'auto'}); }, containment:'document'});
                    </script>

                    </div>
                </div>
            </div>
        </div>
        
        <section class="section section-lg">
            <div class="container">
                <div class="row justify-content-center mb-5 mb-lg-6">
                    <!-- <div class="col-12 col-md-6 text-center mb-4"> -->
                    <!-- </div> -->
                    <div class="accordion" id="accordionSuggestion">
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingOne">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                    data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                    <p class="fw-bold" style="font-size: 1.2rem;">Suggestions</p>
                                </button>
                            </h2>
                            <div id="collapseOne" class="accordion-collapse collapse" aria-labelledby="headingOne"
                                data-bs-parent="#accordionSuggestion">
                                <div class="accordion-body">
                                    <button class="btn btn-outline-danger" type="button" onclick="update_ligand(originalLigand)">Reset</button>
                                    <div class="table-responsive-sm">
                                        <table class="table table-striped" id="list_suggestions">
                                            <thead>
                                                <tr>
                                                    <th scope="col">No.</th>
                                                    <th scope="col">Type</th>
                                                    <th scope="col">Atom index(es)</th>
                                                    <th scope="col">New Atom(s)</th>
                                                    <th scope="col">Apply</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row justify-content-center mb-5 mb-lg-6">
                    <div id="ngl_view" style="width: 100%; height: 80vh; overflow: hidden;" class = "row justify-content-center mb-5 mb-lg-6"></div>
                </div>

                <div class="row justify-content-center mb-5 mb-lg-6">
                    <div class="alert alert-info text-center" style="font-size: 1.6rem;" role="alert">
                        Docking Score: <span class="fw-bold" style="font-size: 1.6rem;" id="docking_score"></span>
                    </div>

                    <!-- <div class="showoutput" style="font-size: 1.6rem;" role="alert">
                            <div class="bi-binoculars-fill">
                                Docking Score:
                                <span class="fw-bold" style="font-size: 1.6rem;" id="docking_score">-0.823</span>
                            </div>
                    </div> -->
                </div>

                <div class="row justify-content-center mb-5 mb-lg-6">
                    <div class="alert alert-light text-center" style="font-size: 1.2rem;" role="alert">
                        Runtime: <span class="fw-bold" style="font-size: 1.2rem;" id="runtime"></span>
                    </div>
                </div>

            </div>
        </section>        

        <div class="d-flex justify-content-center" id="spinner" style="position: fixed; top: 0; left: 0; z-index: 9999; width: 100vw; height: 100vh; background: rgba(255, 255, 255, 0.8); transition: opacity 0.2s; visibility: hidden; opacity: 0;">
            <div class="spinner-border" role="status" style="position: absolute; top: 50%; left: 50%;">
              <span class="visually-hidden">Loading...</span>
            </div>
        </div>

    </main>

    {% include 'includes/footer.html' %}

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}
<script>
    var stage;
    var ligandFile = "";
    var originalLigand = "Molecule from ChemDoodle Web Components\
http://www.ichemlabs.com\
  1  0  0  0  0  0            999 V2000\
    0.0000    0.0000    0.0000 C   0  0  0  0  0  0\
M  END";
    var suggestions = [];

    document.addEventListener("DOMContentLoaded", function (){
        stage = new NGL.Stage("ngl_view");
    });
    
    function loadFileReceptor(receptor_url) {
        stage.removeAllComponents();
        stage.loadFile(receptor_url, { defaultRepresentation: true }).then(function (component) {
            component.autoView(); //auto center screen
        });
    }
    
    function loadFileLigand(ligand_url) {
        stage.removeAllComponents();
        stage.loadFile(ligand_url, { defaultRepresentation: true }).then(function (component) {
            component.autoView(); //auto center screen
        });
    }
    
    function loadFileResult(receptor_url, ligand_url) {
        stage.removeAllComponents();
        
        stage.loadFile(ligand_url, { defaultRepresentation: true });
        stage.loadFile(receptor_url, { defaultRepresentation: true });
    }

    function showDockingScore(score) {
        var elem = document.getElementById('docking_score');
        elem.innerHTML = score;
    }

    function showRuntime(time) {
        var elem = document.getElementById('runtime');
        elem.innerHTML = time + 's';
    }

    function showSuggestions(list_suggestions) {
        var sTable = document.getElementById('list_suggestions');
        sTable.innerHTML = "";

        list_suggestions.forEach((suggestion, idx) => {
            newRow = sTable.insertRow(-1);
            var c1 = document.createElement('td');
            var c2 = document.createElement('td');
            var c3 = document.createElement('td');
            var c4 = document.createElement('td');
            var c5 = document.createElement('td');
            c1.innerHTML = idx;
            c2.innerHTML = suggestion["type"];
            c3.innerHTML = suggestion["atom_idx"];
            c4.innerHTML = suggestion["fragment"];
            apply_button = document.createElement('button');
            apply_button.className = "btn btn-outline-tertiary";
            apply_button.innerHTML = "Apply";
            apply_button.onclick = function(event) {
                apply_suggestion(idx);
            };
            c5.appendChild(apply_button);
            newRow.appendChild(c1);
            newRow.appendChild(c2);
            newRow.appendChild(c3);
            newRow.appendChild(c4);
            newRow.appendChild(c5);
        });

        var header = sTable.createTHead().insertRow(0);;
        var c1 = document.createElement('th');
        var c2 = document.createElement('th');
        var c3 = document.createElement('th');
        var c4 = document.createElement('th');
        var c5 = document.createElement('th');
        c1.innerHTML = "No.";
        c2.innerHTML = "Type";
        c3.innerHTML = "Atom index(es)";
        c4.innerHTML = "New Atom(s)";
        c5.innerHTML = "Apply";
        header.appendChild(c1);
        header.appendChild(c2);
        header.appendChild(c3);
        header.appendChild(c4);
        header.appendChild(c5);
    }

    function view_result(result) {
        ligandFile = result["ligand"];
        suggestions = result["suggestions"];

        showRuntime(result["time"]);
        showDockingScore(result["score"]);
        loadFileResult(result["receptor"], result["ligand"]);
        showSuggestions(result["suggestions"]);
    }

    function update_ligand(molString) {
        var newMol = ChemDoodle.readMOL(molString);
        sketcher.loadMolecule(newMol);
    }

    function apply_suggestion(sIdx) {
        var suggestion_data = suggestions[sIdx];
        suggestion_data["ligand"] = ligandFile;
        $.ajax({
                url: 'apply',
                type: 'POST',
                dataType: 'JSON',
                data: JSON.stringify(suggestion_data)
            }).done(function(result){
                update_ligand(result["ligand"]);
            });
    }

    function submit_compound() {
        let mol = sketcher.getMolecule();
        let molFile = ChemDoodle.writeMOL(mol);

        document.getElementById("spinner").style.visibility = "visible";
        document.getElementById("spinner").style.opacity = "1";

        $.ajax({
                url: 'dock',
                type: 'POST',
                dataType: 'JSON',
                data: JSON.stringify({
                    "ligand": molFile
                })
            }).done(function(result) {
                var isSuccess = true;

                if (result["status"] == "success") {
                    originalLigand = molFile;
                    view_result(result);
                } else {
                    isSuccess = false;
                }
                document.getElementById("spinner").style.visibility = "hidden";
                document.getElementById("spinner").style.opacity = "0";

                if (!isSuccess)
                    alert("Ligand has some error! Please re-check it!");
            }).fail(function() {
                document.getElementById("spinner").style.visibility = "hidden";
                document.getElementById("spinner").style.opacity = "0";

                alert('There are some error! Try again!'); 
            });
    }

</script>
{% endblock javascripts %}
